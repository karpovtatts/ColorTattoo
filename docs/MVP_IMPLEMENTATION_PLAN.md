# План реализации MVP

## Обзор проекта

Веб-приложение для тату-мастеров, помогающее подобрать рецепт смешивания цветов для достижения целевого оттенка. Фокус на практических результатах в тату-практике, предупреждение о грязных смесях.

**Платформа:** Web (браузер)
**Архитектура:** Клиент-сервер, детерминированная логика, без AI
**Хранение:** Серверное, без аутентификации в v1

---

## Этап 1: Базовая инфраструктура и настройка проекта

### 1.1 Инициализация проекта
- Выбор технологического стека (React/Vue/vanilla JS + Node.js/Express или другой backend)
- Настройка структуры проекта (frontend/backend разделение)
- Настройка инструментов сборки и разработки
- Базовая конфигурация окружения

### 1.2 Базовая архитектура
- Создание структуры папок (components, services, utils, models)
- Настройка роутинга (если SPA)
- Базовая система управления состоянием (если нужна)
- Настройка API endpoints структуры

### 1.3 Базовые UI компоненты
- Создание базовых UI компонентов (кнопки, инпуты, контейнеры)
- Настройка системы стилей (CSS modules / styled-components / Tailwind)
- Базовый layout приложения
- Навигация между экранами

**Зависимости:** Нет
**Результат:** Работающий каркас приложения с базовой навигацией

---

## Этап 2: Модель цвета и цветовые утилиты

### 2.1 Цветовые пространства и конвертация
- Реализация работы с RGB, HSL, HEX
- Функции конвертации между цветовыми пространствами
- Валидация цветовых значений
- Утилиты для работы с цветовыми кодами

### 2.2 Базовые цветовые операции
- Функции смешивания цветов (аддитивное/субтрактивное)
- Расчет результирующего цвета из пропорций
- Функции для определения яркости, насыщенности
- Утилиты для сравнения цветов (расстояние в цветовом пространстве)

### 2.3 Модель данных цвета
- Структура данных для базового цвета (название, RGB/HSL, тип)
- Структура данных для рецепта (ингредиенты, пропорции, метаданные)
- Структура данных для палитры пользователя

**Зависимости:** Этап 1
**Результат:** Библиотека утилит для работы с цветами, базовые модели данных

---

## Этап 3: Ввод целевого цвета (F01 - частично)

### 3.1 Ввод через текст/код
- Поле ввода для HEX кода (#RRGGBB)
- Поле ввода для RGB значений
- Парсинг и валидация введенных значений
- Отображение предпросмотра цвета

### 3.2 Цветовой круг (Color Picker)
- Интеграция или создание компонента цветового круга
- Выбор цвета через HSL/Hue
- Отображение выбранного цвета
- Связь с текстовым вводом (синхронизация)

### 3.3 Обработка ввода
- Нормализация введенного цвета в единый формат
- Сохранение целевого цвета в состоянии
- Передача целевого цвета в модуль подбора рецепта

**Зависимости:** Этап 2
**Результат:** Рабочий интерфейс ввода целевого цвета (текст + цветовой круг)

**Примечание:** Фото + пипетка (F08) - низкий приоритет, можно отложить

---

## Этап 4: Настройка палитры пользователя (F02)

### 4.1 Интерфейс управления палитрой
- Экран/секция настройки палитры
- Добавление цвета в палитру (через цветовой круг или код)
- Редактирование существующих цветов
- Удаление цветов из палитры
- Название цветов (опционально)

### 4.2 Хранение палитры
- Сохранение палитры в localStorage (клиент) или на сервере
- Загрузка сохраненной палитры при старте
- Предустановленные базовые палитры (опционально)

### 4.3 Валидация палитры
- Проверка минимального количества цветов
- Проверка уникальности цветов
- Визуализация палитры (цветные квадраты/круги)

**Зависимости:** Этап 2, Этап 3
**Результат:** Функциональная настройка и сохранение пользовательской палитры

---

## Этап 5: Алгоритм подбора рецепта (F01 - основная часть)

### 5.1 Базовый алгоритм подбора
- Алгоритм поиска комбинации цветов из палитры для достижения целевого цвета
- Подход: перебор комбинаций или оптимизация (градиентный спуск, генетический алгоритм)
- Расчет пропорций для найденной комбинации
- Ограничение на количество ингредиентов (например, максимум 3-4 цвета)

### 5.2 Обработка недостижимых цветов
- Определение, когда точное совпадение невозможно
- Поиск ближайшего достижимого цвета
- Расчет расстояния до целевого цвета
- Объяснение, почему цвет недостижим (выход за гамму палитры)

### 5.3 Генерация рецепта
- Форматирование рецепта (список ингредиентов + пропорции)
- Поддержка разных форматов пропорций (части, проценты, соотношения)
- Визуализация рецепта (цветные индикаторы)

**Зависимости:** Этап 2, Этап 4
**Результат:** Рабочий алгоритм подбора рецепта с обработкой недостижимых цветов

---

## Этап 6: Анализ чистый/грязный (F03)

### 6.1 Реализация правил определения грязного цвета
- Правило R01: определение грязного цвета (потеря хроматики, уход в серо-коричневый)
- Правило R02: обнаружение использования черного для затемнения цветных оттенков
- Эвристики для определения "грязности" смеси

### 6.2 Анализ рецепта
- Проверка рецепта на наличие проблемных комбинаций
- Определение риска "грязного" результата
- Расчет вероятности потери хроматики в коже

### 6.3 Предупреждения и объяснения
- Генерация предупреждений для рискованных рецептов
- Объяснение причины проблемы (например, "черный загрязняет цветные оттенки")
- Предложение альтернатив (например, затемнение через комплементарные цвета)

**Зависимости:** Этап 5, Правила R01, R02
**Результат:** Система анализа и предупреждений о грязных смесях

---

## Этап 7: Анализ тёплый/холодный (F04)

### 7.1 Определение теплоты цвета
- Алгоритм определения теплого/холодного характера цвета
- Расчет "температуры" цвета в цветовом пространстве
- Учет влияния смешивания на температуру

### 7.2 Анализ и объяснение
- Определение теплоты целевого цвета
- Определение теплоты результирующего цвета из рецепта
- Объяснение характера цвета (теплый/холодный/нейтральный)

### 7.3 Визуализация
- Визуальные индикаторы теплоты (цветовая шкала, иконки)
- Сравнение целевого и результирующего цвета по температуре

**Зависимости:** Этап 2, Этап 5
**Результат:** Система анализа и отображения теплоты цвета

---

## Этап 8: Отображение рецепта и результатов (F01, F03, F04, F05)

### 8.1 Экран результатов
- Отображение целевого цвета
- Отображение результирующего цвета (из рецепта)
- Визуальное сравнение (рядом или наложением)
- Отображение рецепта (ингредиенты + пропорции)

### 8.2 Визуализация информации
- Индикаторы чистый/грязный (цветовые метки, иконки)
- Индикаторы тёплый/холодный
- Предупреждения (выделение, цвет, иконки)
- Объяснения и подсказки (текстовые блоки)

### 8.3 Обработка недостижимых цветов (F05)
- Отображение ближайшего достижимого цвета
- Визуальное сравнение целевого и ближайшего
- Объяснение, почему точный цвет недостижим
- Показ разницы (визуально и численно)

**Зависимости:** Этап 5, Этап 6, Этап 7
**Результат:** Полноценный экран результатов с рецептом и всеми анализами

---

## Этап 9: Сохранение рецептов и заметок (F06)

### 9.1 Интерфейс сохранения
- Кнопка/действие "Сохранить рецепт"
- Форма для добавления заметок к рецепту
- Редактирование сохраненных заметок

### 9.2 Хранение данных
- Структура данных для сохраненного рецепта (целевой цвет, рецепт, заметки, метаданные)
- Сохранение в localStorage или на сервере
- Уникальные идентификаторы для рецептов
- Timestamp создания/изменения

### 9.3 Просмотр сохраненных рецептов
- Экран/секция со списком сохраненных рецептов
- Визуализация сохраненных рецептов (миниатюры цветов, названия)
- Открытие сохраненного рецепта
- Удаление сохраненных рецептов
- Поиск/фильтрация по сохраненным рецептам

**Зависимости:** Этап 8
**Результат:** Функциональность сохранения и просмотра рецептов с заметками

---

## Этап 10: Интеграция и полировка

### 10.1 Связывание всех компонентов
- Интеграция всех экранов в единый flow
- Проверка передачи данных между компонентами
- Обработка ошибок на всех этапах

### 10.2 UX улучшения
- Загрузочные состояния
- Сообщения об ошибках
- Подтверждения действий (удаление, очистка)
- Подсказки и туториалы (опционально)

### 10.3 Адаптивность
- Адаптивный дизайн для мобильных устройств
- Тестирование на разных размерах экранов
- Оптимизация для touch-интерфейсов

### 10.4 Производительность
- Оптимизация алгоритмов подбора (если медленные)
- Кэширование результатов
- Ленивая загрузка компонентов (если нужно)

**Зависимости:** Все предыдущие этапы
**Результат:** Полностью интегрированное приложение

---

## Этап 11: Тестирование и финализация

### 11.1 Функциональное тестирование
- Тестирование всех основных flow
- Тестирование граничных случаев (пустая палитра, невалидный ввод)
- Тестирование правил чистый/грязный на известных примерах
- Тестирование алгоритма подбора на различных цветах

### 11.2 Тестирование правил
- Проверка правил R01, R02 на тестовых случаях
- Валидация предупреждений о грязных смесях
- Проверка анализа теплоты цвета

### 11.3 Исправление багов
- Исправление найденных проблем
- Оптимизация производительности
- Улучшение точности алгоритмов

### 11.4 Финальная полировка
- Проверка соответствия спецификациям
- Проверка UI/UX согласно 05_ui_ux.md
- Финальная проверка критериев успеха (success_criteria.md)

**Зависимости:** Этап 10
**Результат:** Готовое к использованию MVP приложение

---

## Зависимости между этапами

```
Этап 1 (Инфраструктура)
    ↓
Этап 2 (Модель цвета)
    ↓
Этап 3 (Ввод цвета) ←→ Этап 4 (Палитра)
    ↓
Этап 5 (Алгоритм подбора)
    ↓
Этап 6 (Анализ грязный) + Этап 7 (Анализ тёплый)
    ↓
Этап 8 (Отображение результатов)
    ↓
Этап 9 (Сохранение)
    ↓
Этап 10 (Интеграция)
    ↓
Этап 11 (Тестирование)
```

---

## Приоритеты реализации

### MVP Core (обязательно):
- Этапы 1-9: Полный функционал "ввёл цвет → получил рецепт"
- Этапы 10-11: Интеграция и тестирование

### Отложено на потом:
- F08: Фото + пипетка (низкий приоритет)
- F07: Библиотека цветовых референсов
- F09: Мини-игра для тренировки
- R03, R04: Дополнительные правила (если не описаны в текущих документах)

---

## Открытые вопросы для уточнения

1. **Алгоритм подбора рецепта:** Какой подход использовать? (перебор, оптимизация, эвристики)
2. **Правила R03, R04:** Нужно ли их реализовывать в MVP или они еще не описаны?
3. **Формат пропорций:** Какие форматы предпочтительны? (части, проценты, соотношения)
4. **Серверное хранение:** Нужен ли backend в MVP или достаточно localStorage?
5. **Предустановленные палитры:** Нужны ли базовые палитры по умолчанию?

---

## Критерии готовности MVP

Согласно `success_criteria.md`, MVP считается успешным, если:
- ✅ Тату-мастер реально использует его перед сеансом
- ✅ Исчезает ступор «как это мешать»
- ✅ Приложение помогает избежать грязных оттенков в коже

Это означает, что MVP должен быть:
- Быстрым в использовании
- Точным в подборе рецептов
- Надежным в предупреждениях о грязных смесях
- Понятным в объяснениях

